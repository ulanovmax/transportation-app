const I=(n,...e)=>{const t=e.length;for(let i=0;i<t;i++){const r=e[i]||{};Object.entries(r).forEach(([s,o])=>{const a=Array.isArray(o)?[]:{};var h;n[s]||Object.assign(n,{[s]:a}),typeof(h=o)=="object"&&h!==null&&h.constructor===Object&&Object.prototype.toString.call(h)==="[object Object]"?Object.assign(n[s],I(a,o)):Array.isArray(o)?Object.assign(n,{[s]:[...o]}):Object.assign(n,{[s]:o})})}return n},_=n=>`${n||""}`.split(" ").filter(e=>!!e),O=(n,e)=>{n&&_(e).forEach(t=>{n.classList.add(t)})},E=(n,e)=>{n&&_(e).forEach(t=>{n.classList.remove(t)})},w=function(n,e){return n.split(".").reduce((t,i)=>typeof t=="object"?t[i]:void 0,e)};class M{constructor(e={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(e);for(const t of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))t.startsWith("on")&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}setOptions(e){this.options=e?I({},this.constructor.defaults,e):{};for(const[t,i]of Object.entries(this.option("on")||{}))this.on(t,i)}option(e,...t){let i=w(e,this.options);return i&&typeof i=="function"&&(i=i.call(this,this,...t)),i}optionFor(e,t,i,...r){let s=w(t,e);var o;typeof(o=s)!="string"||isNaN(o)||isNaN(parseFloat(o))||(s=parseFloat(s)),s==="true"&&(s=!0),s==="false"&&(s=!1),s&&typeof s=="function"&&(s=s.call(this,this,e,...r));let a=w(t,this.options);return a&&typeof a=="function"?s=a.call(this,this,e,...r,s):s===void 0&&(s=a),s===void 0?i:s}cn(e){const t=this.options.classes;return t&&t[e]||""}localize(e,t=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,(i,r,s)=>{let o="";return s?o=this.option(`${r[0]+r.toLowerCase().substring(1)}.l10n.${s}`):r&&(o=this.option(`l10n.${r}`)),o||(o=i),o});for(let i=0;i<t.length;i++)e=e.split(t[i][0]).join(t[i][1]);return e=e.replace(/\{\{(.*?)\}\}/g,(i,r)=>r)}on(e,t){let i=[];typeof e=="string"?i=e.split(" "):Array.isArray(e)&&(i=e),this.events||(this.events=new Map),i.forEach(r=>{let s=this.events.get(r);s||(this.events.set(r,[]),s=[]),s.includes(t)||s.push(t),this.events.set(r,s)})}off(e,t){let i=[];typeof e=="string"?i=e.split(" "):Array.isArray(e)&&(i=e),i.forEach(r=>{const s=this.events.get(r);if(Array.isArray(s)){const o=s.indexOf(t);o>-1&&s.splice(o,1)}})}emit(e,...t){[...this.events.get(e)||[]].forEach(i=>i(this,...t)),e!=="*"&&this.emit("*",e,...t)}}Object.defineProperty(M,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.33"}),Object.defineProperty(M,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class C extends M{constructor(e,t){super(t),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:e})}attach(){}detach(){}}var j,x;(function(n){n[n.Init=0]="Init",n[n.Error=1]="Error",n[n.Ready=2]="Ready",n[n.Panning=3]="Panning",n[n.Mousemove=4]="Mousemove",n[n.Destroy=5]="Destroy"})(j||(j={})),function(n){n[n.Init=0]="Init",n[n.Ready=1]="Ready",n[n.Destroy=2]="Destroy"}(x||(x={}));const R=(n,e=1e4)=>(n=parseFloat(n+"")||0,Math.round((n+Number.EPSILON)*e)/e),z={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var P;(function(n){n[n.Init=0]="Init",n[n.Ready=1]="Ready",n[n.Hidden=2]="Hidden"})(P||(P={}));const k="isResting",S="thumbWidth",v="thumbHeight",m="thumbClipWidth";class T extends C{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:P.Init})}get isModern(){return this.type==="modern"}onInitSlide(e,t){const i=t.el?t.el.dataset:void 0;i&&(t.thumbSrc=i.thumbSrc||t.thumbSrc||"",t[m]=parseFloat(i[m]||"")||t[m]||0,t[v]=parseFloat(i.thumbHeight||"")||t[v]||0),this.addSlide(t)}onInitSlides(){this.build()}onChange(){var e;if(!this.isModern)return;const t=this.container,i=this.instance,r=i.panzoom,s=this.carousel,o=s?s.panzoom:null,a=i.page;if(r&&s&&o){if(r.isDragging){E(t,this.cn(k));let f=((e=s.pages[a])===null||e===void 0?void 0:e.pos)||0;f+=i.getProgress(a)*(this[m]+this.thumbGap);let l=o.getBounds();-1*f>l.x.min&&-1*f<l.x.max&&o.panTo({x:-1*f,friction:.12})}else h=t,c=this.cn(k),u=r.isResting,h&&_(c).forEach(f=>{h.classList.toggle(f,u||!1)});var h,c,u;this.shiftModern()}}onRefresh(){this.updateProps();for(const e of this.instance.slides||[])this.resizeModernSlide(e);this.shiftModern()}isDisabled(){const e=this.option("minCount")||0;if(e){const i=this.instance;let r=0;for(const s of i.slides||[])s.thumbSrc&&r++;if(r<e)return!0}const t=this.option("type");return["modern","classic"].indexOf(t)<0}getThumb(e){const t=this.option("thumbTpl")||"";return{html:this.instance.localize(t,[["%i",e.index],["%d",e.index+1],["%s",e.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(e){const t=this.carousel;t&&t.addSlide(e.index,this.getThumb(e))}getSlides(){const e=[];for(const t of this.instance.slides||[])e.push(this.getThumb(t));return e}resizeModernSlide(e){this.isModern&&(e[S]=e[m]&&e[v]?Math.round(this[v]*(e[m]/e[v])):this[S])}updateProps(){const e=this.container;if(!e)return;const t=i=>parseFloat(getComputedStyle(e).getPropertyValue("--f-thumb-"+i))||0;this.thumbGap=t("gap"),this.thumbExtraGap=t("extra-gap"),this[S]=t("width")||40,this[m]=t("clip-width")||40,this[v]=t("height")||40}build(){const e=this;if(e.state!==P.Init)return;if(e.isDisabled())return void e.emit("disabled");const t=e.instance,i=t.container,r=e.getSlides(),s=e.option("type");e.type=s;const o=e.option("parentEl"),a=e.cn("container"),h=e.cn("track");let c=o==null?void 0:o.querySelector("."+a);c||(c=document.createElement("div"),O(c,a),o?o.appendChild(c):i.after(c)),O(c,`is-${s}`),O(i,e.cn("hasThumbs")),e.container=c,e.updateProps();let u=c.querySelector("."+h);u||(u=document.createElement("div"),O(u,e.cn("track")),c.appendChild(u)),e.track=u;const f=I({},{track:u,infinite:!1,center:!0,fill:s==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},e.option("Carousel")||{},{Sync:{target:t},slides:r}),l=new t.constructor(c,f);l.on("createSlide",(p,g)=>{e.setProps(g.index),e.emit("createSlide",g,g.el)}),l.on("ready",()=>{e.shiftModern(),e.emit("ready")}),l.on("refresh",()=>{e.shiftModern()}),l.on("Panzoom.click",(p,g,d)=>{e.onClick(d)}),e.carousel=l,e.state=P.Ready}onClick(e){e.preventDefault(),e.stopPropagation();const t=this.instance,{pages:i,page:r}=t,s=b=>{if(b){const y=b.closest("[data-carousel-index]");if(y)return[parseInt(y.dataset.carouselIndex||"",10)||0,y]}return[-1,void 0]},o=(b,y)=>{const A=document.elementFromPoint(b,y);return A?s(A):[-1,void 0]};let[a,h]=s(e.target);if(a>-1)return;const c=this[m],u=e.clientX,f=e.clientY;let[l,p]=o(u-c,f),[g,d]=o(u+c,f);p&&d?(a=Math.abs(u-p.getBoundingClientRect().right)<Math.abs(u-d.getBoundingClientRect().left)?l:g,a===r&&(a=a===l?g:l)):p?a=l:d&&(a=g),a>-1&&i[a]&&t.slideTo(a)}getShift(e){var t;const i=this,{instance:r}=i,s=i.carousel;if(!r||!s)return 0;const o=i[S],a=i[m],h=i.thumbGap,c=i.thumbExtraGap;if(!(!((t=s.slides[e])===null||t===void 0)&&t.el))return 0;const u=.5*(o-a),f=r.pages.length-1;let l=r.getProgress(0),p=r.getProgress(f),g=r.getProgress(e,!1,!0),d=0,b=u+c+h;const y=l<0&&l>-1,A=p>0&&p<1;return e===0?(d=b*Math.abs(l),A&&l===1&&(d-=b*Math.abs(p))):e===f?(d=b*Math.abs(p)*-1,y&&p===-1&&(d+=b*Math.abs(l))):y||A?(d=-1*b,d+=b*Math.abs(l),d+=b*(1-Math.abs(p))):d=b*g,d}setProps(e){var t;const i=this;if(!i.isModern)return;const{instance:r}=i,s=i.carousel;if(r&&s){const o=(t=s.slides[e])===null||t===void 0?void 0:t.el;if(o&&o.childNodes.length){let a=R(1-Math.abs(r.getProgress(e))),h=R(i.getShift(e));o.style.setProperty("--progress",a?a+"":""),o.style.setProperty("--shift",h+"")}}}shiftModern(){const e=this;if(!e.isModern)return;const{instance:t,track:i}=e,r=t.panzoom,s=e.carousel;if(!(t&&i&&r&&s)||r.state===j.Init||r.state===j.Destroy)return;for(const a of t.slides)e.setProps(a.index);let o=(e[m]+e.thumbGap)*(s.slides.length||0);i.style.setProperty("--width",o+"")}cleanup(){const e=this;e.carousel&&e.carousel.destroy(),e.carousel=null,e.container&&e.container.remove(),e.container=null,e.track&&e.track.remove(),e.track=null,e.state=P.Init,E(e.instance.container,e.cn("hasThumbs"))}attach(){const e=this,t=e.instance;t.on("initSlide",e.onInitSlide),t.state===x.Init?t.on("initSlides",e.onInitSlides):e.onInitSlides(),t.on(["change","Panzoom.afterTransform"],e.onChange),t.on("Panzoom.refresh",e.onRefresh)}detach(){const e=this,t=e.instance;t.off("initSlide",e.onInitSlide),t.off("initSlides",e.onInitSlides),t.off(["change","Panzoom.afterTransform"],e.onChange),t.off("Panzoom.refresh",e.onRefresh),e.cleanup()}}Object.defineProperty(T,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:z});export{P as States,T as Thumbs,z as defaultOptions};
//# sourceMappingURL=carousel.thumbs.esm-ChVv7N2C.js.map
